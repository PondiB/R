\documentclass[]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
\else % if luatex or xelatex
  \ifxetex
    \usepackage{mathspec}
    \usepackage{xltxtra,xunicode}
  \else
    \usepackage{fontspec}
  \fi
  \defaultfontfeatures{Mapping=tex-text,Scale=MatchLowercase}
  \newcommand{\euro}{â‚¬}
\fi
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{{#1}}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{{#1}}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{{#1}}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{{#1}}}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{{#1}}}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{{#1}}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{{#1}}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{{#1}}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{{#1}}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{{#1}}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{{#1}}}
\newcommand{\RegionMarkerTok}[1]{{#1}}
\newcommand{\ErrorTok}[1]{\textbf{{#1}}}
\newcommand{\NormalTok}[1]{{#1}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
\ifxetex
  \usepackage[setpagesize=false, % page size defined by xetex
              unicode=false, % unicode breaks when used with xetex
              xetex]{hyperref}
\else
  \usepackage[unicode=true]{hyperref}
\fi
\hypersetup{breaklinks=true,
            bookmarks=true,
            pdfauthor={John Mutua},
            pdftitle={NDVI time series analysis},
            colorlinks=true,
            citecolor=blue,
            urlcolor=blue,
            linkcolor=magenta,
            pdfborder={0 0 0}}
\urlstyle{same}  % don't use monospace font for urls
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\setcounter{secnumdepth}{0}

%%% Use protect on footnotes to avoid problems with footnotes in titles
\let\rmarkdownfootnote\footnote%
\def\footnote{\protect\rmarkdownfootnote}

%%% Change title format to be more compact
\usepackage{titling}

% Create subtitle command for use in maketitle
\newcommand{\subtitle}[1]{
  \posttitle{
    \begin{center}\large#1\end{center}
    }
}

\setlength{\droptitle}{-2em}
  \title{NDVI time series analysis}
  \pretitle{\vspace{\droptitle}\centering\huge}
  \posttitle{\par}
  \author{John Mutua}
  \preauthor{\centering\large\emph}
  \postauthor{\par}
  \predate{\centering\large\emph}
  \postdate{\par}
  \date{11 October, 2016, 23:00}

\usepackage{fancyhdr}
\pagestyle{fancy}
\rhead{\includegraphics[width = .05\textwidth]{ciat_142_50.png}}


\begin{document}

\maketitle


\subsubsection{Objectives}\label{objectives}

This manual will help you construct a time series using MODIS data. At
the end of this session, you will be able to:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\itemsep1pt\parskip0pt\parsep0pt
\item
  Import NDVI data into R software
\item
  Insert a temporal ID into the data
\item
  Create a time series
\item
  Plot and export graphs
\end{enumerate}

For more details on source of MODIS data see
\url{http://pekko.geog.umd.edu/usda/beta/data_new.php}. Otherwise,
download the sample dataset we will use in this session from this link
\url{https://drive.google.com/open?id=0B_Gkb_0tNKkQUVc5NUhKRzlhZTg}

Before you start this session, it is important you have (i) the latest
\href{https://cran.r-project.org/bin/windows/base/}{R software} and (ii)
\href{https://www.rstudio.com/}{Rstudio} installed in your computer.

You can now start the session but first clear your work space:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{rm}\NormalTok{(}\DataTypeTok{list =} \KeywordTok{ls}\NormalTok{(}\DataTypeTok{all =} \OtherTok{TRUE}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\subsubsection{Preliminaries}\label{preliminaries}

You need to first install all the required packages. Type (within R)
install packages(``name of package'') (This needs to be done just
once.). You then load the packages using the `library' function:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(raster) }\CommentTok{#working with rasters}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Loading required package: sp
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(rgdal) }\CommentTok{#working with geospatial data}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## rgdal: version: 1.1-8, (SVN revision 616)
##  Geospatial Data Abstraction Library extensions to R successfully loaded
##  Loaded GDAL runtime: GDAL 2.0.1, released 2015/09/15
##  Path to GDAL shared files: C:/Users/jymutua/Documents/R/win-library/3.1/rgdal/gdal
##  GDAL does not use iconv for recoding strings.
##  Loaded PROJ.4 runtime: Rel. 4.9.1, 04 March 2015, [PJ_VERSION: 491]
##  Path to PROJ.4 shared files: C:/Users/jymutua/Documents/R/win-library/3.1/rgdal/proj
##  Linking to sp version: 1.2-3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(ggplot2) }\CommentTok{#creating graphs}
\KeywordTok{library}\NormalTok{(dplyr) }\CommentTok{#subsetting by season}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Attaching package: 'dplyr'
\end{verbatim}

\begin{verbatim}
## The following objects are masked from 'package:raster':
## 
##     intersect, select, union
\end{verbatim}

\begin{verbatim}
## The following objects are masked from 'package:stats':
## 
##     filter, lag
\end{verbatim}

\begin{verbatim}
## The following objects are masked from 'package:base':
## 
##     intersect, setdiff, setequal, union
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(lubridate) }\CommentTok{#working with dates}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Attaching package: 'lubridate'
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:base':
## 
##     date
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(grid) }\CommentTok{#arranging plots}
\KeywordTok{library}\NormalTok{(gridExtra) }\CommentTok{#arranging plots}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Attaching package: 'gridExtra'
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:dplyr':
## 
##     combine
\end{verbatim}

Set your working directory as follows:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{setwd}\NormalTok{(}\StringTok{"C:/LDN_Workshop/Sample_dataset/NDVI_data"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

This needs to be done every time you start R. (There is a way to have
the package loaded automatically every time, but we won't discuss that
here). To get help on the functions and data sets in R, use
\texttt{help()} or \texttt{?}. For example, to view the help file for
the \texttt{calc} function, type one of the following:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{help}\NormalTok{(calc)}
\NormalTok{?calc}
\end{Highlighting}
\end{Shaded}

Import all NDVI raster datasets in your working directory and create a
raster stack

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{NDVI_Otji_stack <-}\StringTok{ }\KeywordTok{stack}\NormalTok{(}\KeywordTok{list.files}\NormalTok{(}\KeywordTok{getwd}\NormalTok{(), }\DataTypeTok{full.names =} \OtherTok{TRUE}\NormalTok{, }
                                    \DataTypeTok{pattern =} \StringTok{".tif$"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

Insert a Temporal id to the data frame. Characters corresponding to the
year are located between the 20 and 23 position, while characters
corresponding to the date are located between the 24 and 26 position

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{oldnames<-}\KeywordTok{names}\NormalTok{(NDVI_Otji_stack)}
\KeywordTok{head}\NormalTok{(oldnames)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "Otjozondjupa_NDVI_.2005001.C05.NDVI.MOD44.D16.R000250.MODAPS.v2_wm2"
## [2] "Otjozondjupa_NDVI_.2005017.C05.NDVI.MOD44.D16.R000250.MODAPS.v2_wm2"
## [3] "Otjozondjupa_NDVI_.2005033.C05.NDVI.MOD44.D16.R000250.MODAPS.v2_wm2"
## [4] "Otjozondjupa_NDVI_.2005049.C05.NDVI.MOD44.D16.R000250.MODAPS.v2_wm2"
## [5] "Otjozondjupa_NDVI_.2005065.C05.NDVI.MOD44.D16.R000250.MODAPS.v2_wm2"
## [6] "Otjozondjupa_NDVI_.2005081.C05.NDVI.MOD44.D16.R000250.MODAPS.v2_wm2"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{year<-}\KeywordTok{substr}\NormalTok{(oldnames,}\DecValTok{20}\NormalTok{,}\DecValTok{23}\NormalTok{)}
\KeywordTok{table}\NormalTok{(year)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## year
## 2005 2006 2007 2008 2009 2010 2011 2012 2013 2014 2015 
##   23   23   23   22   23   23   23   23   23   23   23
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{julianDay<-}\KeywordTok{substr}\NormalTok{(oldnames,}\DecValTok{24}\NormalTok{,}\DecValTok{26}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Calculate mean NDVI for each raster and convert output array to a data
frame

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{avg_NDVI_Otji <-}\StringTok{ }\KeywordTok{as.data.frame}\NormalTok{(}\KeywordTok{cellStats}\NormalTok{(NDVI_Otji_stack,mean))}
\end{Highlighting}
\end{Shaded}

Rename the NDVI column

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{names}\NormalTok{(avg_NDVI_Otji) <-}\StringTok{ "meanNDVI"}
\end{Highlighting}
\end{Shaded}

Add julianDay values as a column in the data frame

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{avg_NDVI_Otji$julianDay <-}\StringTok{ }\NormalTok{julianDay}
\end{Highlighting}
\end{Shaded}

Check out the class in the new column

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{class}\NormalTok{(avg_NDVI_Otji$julianDay)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "character"
\end{verbatim}

Create a time vector and convert it to a date

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{tVector<-}\KeywordTok{paste}\NormalTok{(year,julianDay,}\DataTypeTok{sep=}\StringTok{"-"}\NormalTok{)}
\NormalTok{timeNDVI<-}\KeywordTok{as.Date}\NormalTok{(tVector,}\DataTypeTok{format =} \StringTok{"%Y-%j"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Add date values as a column in the data frame

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{avg_NDVI_Otji$date <-}\StringTok{ }\NormalTok{timeNDVI}
\end{Highlighting}
\end{Shaded}

Check out classes of the two columns now

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{class}\NormalTok{(avg_NDVI_Otji$date)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "Date"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{class}\NormalTok{(avg_NDVI_Otji$julianDay)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "character"
\end{verbatim}

Add site and year columns to the data frame

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{avg_NDVI_Otji$site <-}\StringTok{ "Otjiwarongo Region"}
\NormalTok{avg_NDVI_Otji$year <-}\StringTok{ }\NormalTok{year}
\end{Highlighting}
\end{Shaded}

\subsubsection{Plot time series}\label{plot-time-series}

Plot NDVI by year although this doesn't make sense

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{ggplot}\NormalTok{(avg_NDVI_Otji, }\KeywordTok{aes}\NormalTok{(year, meanNDVI), }\DataTypeTok{na.rm=}\OtherTok{TRUE}\NormalTok{) +}
\StringTok{  }\KeywordTok{geom_point}\NormalTok{(}\DataTypeTok{size=}\DecValTok{4}\NormalTok{,}\DataTypeTok{colour =} \StringTok{"PeachPuff4"}\NormalTok{) +}\StringTok{ }
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"MODIS Derived NDVI - Otjiwarongo Region"}\NormalTok{) +}
\StringTok{  }\KeywordTok{xlab}\NormalTok{(}\StringTok{"Time"}\NormalTok{) +}\StringTok{ }\KeywordTok{ylab}\NormalTok{(}\StringTok{"Mean NDVI"}\NormalTok{) +}
\StringTok{  }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{text =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{size=}\DecValTok{20}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics{MODIS_TimeSeriesProcessor_files/figure-latex/unnamed-chunk-15-1.pdf}

Write NDVI data to a comma separated file in your local drive, Drop the
row names column

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Otji_NDVI_Values<-avg_NDVI_Otji}
\KeywordTok{row.names}\NormalTok{(Otji_NDVI_Values)<-}\OtherTok{NULL}
\KeywordTok{write.csv}\NormalTok{(Otji_NDVI_Values, }\DataTypeTok{file=}\StringTok{"meanNDVI_Otji_2005-2015.csv"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Add month to data frame

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{avg_NDVI_Otji$month  <-}\StringTok{ }\KeywordTok{month}\NormalTok{(avg_NDVI_Otji$date)}
\end{Highlighting}
\end{Shaded}

Subset data by season by creating a new categorical variable called
season by grouping months together

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{avg_NDVI_Otji_Seasons <-}\StringTok{ }\NormalTok{avg_NDVI_Otji %>%}\StringTok{ }
\StringTok{  }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{season =} 
           \KeywordTok{ifelse}\NormalTok{(month %in%}\StringTok{ }\KeywordTok{c}\NormalTok{(}\DecValTok{12}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{5}\NormalTok{), }\StringTok{"Hot-Wet"}\NormalTok{,}
                  \KeywordTok{ifelse}\NormalTok{(month %in%}\StringTok{ }\KeywordTok{c}\NormalTok{(}\DecValTok{6}\NormalTok{, }\DecValTok{7}\NormalTok{, }\DecValTok{8}\NormalTok{), }\StringTok{"Cool-Dry"}\NormalTok{,}
                         \KeywordTok{ifelse}\NormalTok{(month %in%}\StringTok{ }\KeywordTok{c}\NormalTok{(}\DecValTok{9}\NormalTok{, }\DecValTok{10}\NormalTok{, }\DecValTok{11}\NormalTok{), }\StringTok{"Hot-Dry"}\NormalTok{, }\StringTok{"Error"}\NormalTok{))))}
\end{Highlighting}
\end{Shaded}

Let's check to see if that worked

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{head}\NormalTok{(avg_NDVI_Otji_Seasons$month)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1 1 2 2 3 3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{head}\NormalTok{(avg_NDVI_Otji_Seasons$season)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "Hot-Wet" "Hot-Wet" "Hot-Wet" "Hot-Wet" "Hot-Wet" "Hot-Wet"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{tail}\NormalTok{(avg_NDVI_Otji_Seasons$month)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1]  9 10 11 11 12 12
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{tail}\NormalTok{(avg_NDVI_Otji_Seasons$season)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "Hot-Dry" "Hot-Dry" "Hot-Dry" "Hot-Dry" "Hot-Wet" "Hot-Wet"
\end{verbatim}

\subsubsection{Start of monthly plots}\label{start-of-monthly-plots}

Aggregate data by month

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{monthNDVI<-avg_NDVI_Otji_Seasons %>%}
\StringTok{  }\KeywordTok{group_by}\NormalTok{(month) %>%}
\StringTok{  }\KeywordTok{summarise}\NormalTok{(}\DataTypeTok{monthNDVI=}\KeywordTok{mean}\NormalTok{(meanNDVI, }\DataTypeTok{na.rm=}\OtherTok{TRUE}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

Convert month numeric to month abbreviation

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{monthNDVI$month_name <-}\StringTok{ }\NormalTok{month.abb[monthNDVI$month]}
\end{Highlighting}
\end{Shaded}

Reassign the `month\_name' field to a factor

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{monthNDVI$month_name =}\StringTok{ }\KeywordTok{factor}\NormalTok{(monthNDVI$month_name,}
                              \DataTypeTok{levels=}\KeywordTok{c}\NormalTok{(}\StringTok{'Jan'}\NormalTok{,}\StringTok{'Feb'}\NormalTok{,}\StringTok{'Mar'}\NormalTok{,}
                                       \StringTok{'Apr'}\NormalTok{,}\StringTok{'May'}\NormalTok{,}\StringTok{'Jun'}\NormalTok{,}\StringTok{'Jul'}\NormalTok{,}
                                       \StringTok{'Aug'}\NormalTok{,}\StringTok{'Sep'}\NormalTok{,}\StringTok{'Oct'}\NormalTok{,}
                                       \StringTok{'Nov'}\NormalTok{,}\StringTok{'Dec'}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

Plot data by month

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Monthly_NDVI_Plot<-}\KeywordTok{ggplot}\NormalTok{(monthNDVI, }\KeywordTok{aes}\NormalTok{(month_name, monthNDVI, }\DataTypeTok{group=}\DecValTok{4}\NormalTok{)) +}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\DataTypeTok{colour=}\StringTok{"red"}\NormalTok{) +}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Average NDVI (2005-2015) - Monthly"}\NormalTok{) +}
\StringTok{  }\KeywordTok{xlab}\NormalTok{(}\StringTok{"Month"}\NormalTok{) +}\StringTok{ }\KeywordTok{ylab}\NormalTok{(}\StringTok{"Mean NDVI"}\NormalTok{) +}
\StringTok{  }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{plot.title =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{lineheight=}\NormalTok{.}\DecValTok{8}\NormalTok{, }\DataTypeTok{face=}\StringTok{"bold"}\NormalTok{,}
                                  \DataTypeTok{size =} \DecValTok{20}\NormalTok{)) +}
\StringTok{  }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{text =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{size=}\DecValTok{18}\NormalTok{)) +}\StringTok{ }\KeywordTok{geom_point}\NormalTok{()}
\NormalTok{Monthly_NDVI_Plot}
\end{Highlighting}
\end{Shaded}

\includegraphics{MODIS_TimeSeriesProcessor_files/figure-latex/unnamed-chunk-23-1.pdf}

Plot the same plot as before but with one plot per season, save as .pdf

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{ggsave}\NormalTok{(}\DataTypeTok{file=}\StringTok{"Otjiwarongo_Monthly_NDVI.pdf"}\NormalTok{, }\DataTypeTok{width =} \DecValTok{297}\NormalTok{, }\DataTypeTok{height =} \DecValTok{210}\NormalTok{, }\DataTypeTok{units =} 
         \StringTok{"mm"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\subsubsection{Start of indivindual seasonal
plots}\label{start-of-indivindual-seasonal-plots}

Plot HOT-WET Season

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Hot_Wet <-}\StringTok{ }\KeywordTok{subset}\NormalTok{(monthNDVI, month >=}\StringTok{ }\DecValTok{12} \NormalTok{|}\StringTok{ }\NormalTok{month <=}\StringTok{ }\DecValTok{5}\NormalTok{)}
\NormalTok{target <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"12"}\NormalTok{, }\StringTok{"5"}\NormalTok{, }\StringTok{"4"}\NormalTok{, }\StringTok{"3"}\NormalTok{, }\StringTok{"2"}\NormalTok{, }\StringTok{"1"}\NormalTok{)}
\NormalTok{Hot_Wet<-Hot_Wet[}\KeywordTok{match}\NormalTok{(target, Hot_Wet$month),]}
\NormalTok{Hot_Wet$month_name <-}\StringTok{ }\KeywordTok{factor}\NormalTok{(Hot_Wet$month_name, }\KeywordTok{c}\NormalTok{(}\StringTok{"Dec"}\NormalTok{, }\StringTok{"Jan"}\NormalTok{, }\StringTok{"Feb"}\NormalTok{, }\StringTok{"Mar"}\NormalTok{, }
                                                   \StringTok{"Apr"}\NormalTok{, }\StringTok{"May"}\NormalTok{))}
\NormalTok{Hot_Wet_NDVI_Plot<-}\KeywordTok{ggplot}\NormalTok{(Hot_Wet, }\KeywordTok{aes}\NormalTok{(month_name, monthNDVI, }\DataTypeTok{group=}\DecValTok{1}\NormalTok{)) +}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\DataTypeTok{colour=}\StringTok{"red"}\NormalTok{) +}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Average NDVI (2005-2015) - Hot Wet Season "}\NormalTok{) +}
\StringTok{  }\KeywordTok{xlab}\NormalTok{(}\StringTok{"Month"}\NormalTok{) +}\StringTok{ }\KeywordTok{ylab}\NormalTok{(}\StringTok{"Mean NDVI"}\NormalTok{) +}
\StringTok{  }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{plot.title =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{lineheight=}\NormalTok{.}\DecValTok{8}\NormalTok{, }\DataTypeTok{face=}\StringTok{"bold"}\NormalTok{,}
                                  \DataTypeTok{size =} \DecValTok{20}\NormalTok{)) +}
\StringTok{  }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{text =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{size=}\DecValTok{18}\NormalTok{)) +}\StringTok{ }\KeywordTok{geom_point}\NormalTok{()}
\NormalTok{Hot_Wet_NDVI_Plot}
\end{Highlighting}
\end{Shaded}

\includegraphics{MODIS_TimeSeriesProcessor_files/figure-latex/unnamed-chunk-25-1.pdf}

Plot the same plot as before but with one plot per season, save as .pdf

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{ggsave}\NormalTok{(}\DataTypeTok{file=}\StringTok{"Otjiwarongo_Hot_Wet_NDVI.pdf"}\NormalTok{, }\DataTypeTok{width =} \DecValTok{297}\NormalTok{, }\DataTypeTok{height =} \DecValTok{210}\NormalTok{, }\DataTypeTok{units =} 
         \StringTok{"mm"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Plot COOL-DRY Season

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Cool_Dry <-}\StringTok{ }\KeywordTok{subset}\NormalTok{(monthNDVI, month <=}\StringTok{ }\DecValTok{8} \NormalTok{&}\StringTok{ }\NormalTok{month >=}\StringTok{ }\DecValTok{6}\NormalTok{)}
\NormalTok{Cool_Dry_NDVI_Plot<-}\KeywordTok{ggplot}\NormalTok{(Cool_Dry, }\KeywordTok{aes}\NormalTok{(month_name, monthNDVI, }\DataTypeTok{group=}\DecValTok{1}\NormalTok{)) +}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\DataTypeTok{colour=}\StringTok{"red"}\NormalTok{) +}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Average NDVI (2005-2015) - Cool Dry Season"}\NormalTok{) +}
\StringTok{  }\KeywordTok{xlab}\NormalTok{(}\StringTok{"Month"}\NormalTok{) +}\StringTok{ }\KeywordTok{ylab}\NormalTok{(}\StringTok{"Mean NDVI"}\NormalTok{) +}
\StringTok{  }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{plot.title =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{lineheight=}\NormalTok{.}\DecValTok{8}\NormalTok{, }\DataTypeTok{face=}\StringTok{"bold"}\NormalTok{,}
                                  \DataTypeTok{size =} \DecValTok{20}\NormalTok{)) +}
\StringTok{  }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{text =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{size=}\DecValTok{18}\NormalTok{)) +}\StringTok{ }\KeywordTok{geom_point}\NormalTok{()}
\NormalTok{Cool_Dry_NDVI_Plot}
\end{Highlighting}
\end{Shaded}

\includegraphics{MODIS_TimeSeriesProcessor_files/figure-latex/unnamed-chunk-27-1.pdf}

Plot the same plot as before but with one plot per season, save as .pdf

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{ggsave}\NormalTok{(}\DataTypeTok{file=}\StringTok{"Otjiwarongo_Cool_Dry_NDVI.pdf"}\NormalTok{, }\DataTypeTok{width =} \DecValTok{297}\NormalTok{, }\DataTypeTok{height =} \DecValTok{210}\NormalTok{, }\DataTypeTok{units =} 
         \StringTok{"mm"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Plot HOT DRY Season

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Hot_Dry <-}\StringTok{ }\KeywordTok{subset}\NormalTok{(monthNDVI, month <=}\StringTok{ }\DecValTok{11} \NormalTok{&}\StringTok{ }\NormalTok{month >=}\StringTok{ }\DecValTok{9}\NormalTok{)}
\NormalTok{Hot_Dry_NDVI_Plot<-}\KeywordTok{ggplot}\NormalTok{(Hot_Dry, }\KeywordTok{aes}\NormalTok{(month_name, monthNDVI, }\DataTypeTok{group=}\DecValTok{1}\NormalTok{)) +}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\DataTypeTok{colour=}\StringTok{"red"}\NormalTok{) +}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Average NDVI (2005-2015) - Hot Dry Season"}\NormalTok{) +}
\StringTok{  }\KeywordTok{xlab}\NormalTok{(}\StringTok{"Month"}\NormalTok{) +}\StringTok{ }\KeywordTok{ylab}\NormalTok{(}\StringTok{"Mean NDVI"}\NormalTok{) +}
\StringTok{  }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{plot.title =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{lineheight=}\NormalTok{.}\DecValTok{8}\NormalTok{, }\DataTypeTok{face=}\StringTok{"bold"}\NormalTok{,}
                                  \DataTypeTok{size =} \DecValTok{20}\NormalTok{)) +}
\StringTok{  }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{text =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{size=}\DecValTok{18}\NormalTok{)) +}\StringTok{ }\KeywordTok{geom_point}\NormalTok{()}
\NormalTok{Hot_Dry_NDVI_Plot}
\end{Highlighting}
\end{Shaded}

\includegraphics{MODIS_TimeSeriesProcessor_files/figure-latex/unnamed-chunk-29-1.pdf}

Plot the same plot as before but with one plot per season, save as .pdf

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{ggsave}\NormalTok{(}\DataTypeTok{file=}\StringTok{"Otjiwarongo_Hot_Dry_NDVI.pdf"}\NormalTok{, }\DataTypeTok{width =} \DecValTok{297}\NormalTok{, }\DataTypeTok{height =} \DecValTok{210}\NormalTok{, }\DataTypeTok{units =} 
         \StringTok{"mm"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\subsubsection{Start of merged seasonal
plots}\label{start-of-merged-seasonal-plots}

Let's aggregate data by season

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{seasonNDVI<-avg_NDVI_Otji_Seasons %>%}
\StringTok{  }\KeywordTok{group_by}\NormalTok{(year, season) %>%}
\StringTok{  }\KeywordTok{summarise}\NormalTok{(}\DataTypeTok{seasonNDVI=}\KeywordTok{mean}\NormalTok{(meanNDVI, }\DataTypeTok{na.rm=}\OtherTok{TRUE}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

Export comma separated file of seasonal NDVI values

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{write.csv}\NormalTok{(seasonNDVI, }\DataTypeTok{file=}\StringTok{"Seasonal_NDVI_2005-2015.csv"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Plot data by season

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Seasonal_NDVI_Plot<-}\KeywordTok{ggplot}\NormalTok{(seasonNDVI, }\KeywordTok{aes}\NormalTok{(year, seasonNDVI, }\DataTypeTok{group=}\DecValTok{3}\NormalTok{)) +}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\DataTypeTok{colour=}\StringTok{"red"}\NormalTok{) +}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Average NDVI (2005-2015) - Seasonal"}\NormalTok{) +}
\StringTok{  }\KeywordTok{xlab}\NormalTok{(}\StringTok{"Year"}\NormalTok{) +}\StringTok{ }\KeywordTok{ylab}\NormalTok{(}\StringTok{"Mean NDVI"}\NormalTok{) +}
\StringTok{  }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{plot.title =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{lineheight=}\NormalTok{.}\DecValTok{8}\NormalTok{, }\DataTypeTok{face=}\StringTok{"bold"}\NormalTok{,}
                                  \DataTypeTok{size =} \DecValTok{20}\NormalTok{)) +}
\StringTok{  }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{text =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{size=}\DecValTok{18}\NormalTok{)) +}\StringTok{ }\KeywordTok{geom_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

Plot the same plot as before but with one plot per season, save as .pdf

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Seasonal_NDVI_Plot +}\StringTok{ }\KeywordTok{facet_grid}\NormalTok{(. ~}\StringTok{ }\NormalTok{season)}
\end{Highlighting}
\end{Shaded}

\includegraphics{MODIS_TimeSeriesProcessor_files/figure-latex/unnamed-chunk-34-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{ggsave}\NormalTok{(}\DataTypeTok{file=}\StringTok{"Otjiwarongo_Seasonal_NDVI.pdf"}\NormalTok{, }\DataTypeTok{width =} \DecValTok{297}\NormalTok{, }\DataTypeTok{height =} \DecValTok{210}\NormalTok{, }\DataTypeTok{units =} 
         \StringTok{"mm"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Plot the same plot in a landscape orientation, save as .pdf

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Seasonal_NDVI_Plot +}\StringTok{ }\KeywordTok{facet_grid}\NormalTok{(season ~}\StringTok{ }\NormalTok{.)}
\end{Highlighting}
\end{Shaded}

\includegraphics{MODIS_TimeSeriesProcessor_files/figure-latex/unnamed-chunk-35-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{ggsave}\NormalTok{(}\DataTypeTok{file=}\StringTok{"Otjiwarongo_Seasonal_NDVI.pdf"}\NormalTok{, }\DataTypeTok{width =} \DecValTok{297}\NormalTok{, }\DataTypeTok{height =} \DecValTok{210}\NormalTok{, }\DataTypeTok{units =} 
         \StringTok{"mm"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\end{document}
